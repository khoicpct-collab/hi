<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XIN CH√ÄO VI·ªÜT NAM - M√¥ Ph·ªèng D√≤ng Ch·∫£y V·∫≠t Li·ªáu 2D</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* CSS cho ch·∫ø ƒë·ªô v·∫Ω */
        .drawing-mode {
            cursor: crosshair !important;
        }
        /* CSS cho ch·∫ø ƒë·ªô ch·ªânh s·ª≠a */
        .edit-mode {
            cursor: pointer !important;
        }
        /* CSS cho ch·∫ø ƒë·ªô k√©o ƒëi·ªÉm neo */
        .grabbing {
            cursor: grabbing !important;
        }
        .flow-container {
            /* Background nh·∫°t ƒë·ªÉ l√†m n·ªïi b·∫≠t canvas */
            background-color: #f7fafc; /* M√†u x√°m nh·∫°t */
            min-height: 100vh;
        }
        /* T√πy ch·ªânh thanh tr∆∞·ª£t ƒë·ªÉ n·ªïi b·∫≠t */
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #4f46e5; /* M√†u Indigo */
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 2px rgba(0,0,0,0.5);
        }
        .canvas-area {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="flow-container">

    <div class="bg-indigo-700 py-4 shadow-xl mb-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <h1 class="text-3xl font-extrabold tracking-wider text-white">
                XIN CH√ÄO VI·ªÜT NAM
            </h1>
            <p class="text-xs text-indigo-300 font-medium">v1.1.0</p>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-10">
        <div class="flex flex-col lg:flex-row gap-6">

            <div class="lg:w-1/4 space-y-6 p-4 bg-white rounded-xl shadow-lg order-2 lg:order-1">
                <p class="text-xl font-bold text-gray-800 border-b pb-2">üõ†Ô∏è Thi·∫øt L·∫≠p</p>

                <div class="p-4 border rounded-lg bg-gray-50 space-y-3">
                    <p class="text-lg font-semibold text-gray-700">·∫¢nh & V·∫≠t Li·ªáu</p>
                    <div>
                        <label for="baseImageUpload" class="block text-sm font-medium text-gray-700 mb-1">1. B·∫£n V·∫Ω N·ªÅn (Thi·∫øt b·ªã)</label>
                        <input type="file" id="baseImageUpload" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
                    </div>
                    <div>
                        <label for="materialImageUpload" class="block text-sm font-medium text-gray-700 mb-1">2. ·∫¢nh V·∫≠t Li·ªáu (T·ªëi ∆∞u 32x32px)</label>
                        <input type="file" id="materialImageUpload" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
                    </div>
                </div>

                <div class="p-4 border rounded-lg bg-gray-50 space-y-3">
                    <p class="text-lg font-semibold text-gray-700">T√πy Ch·ªânh</p>
                    
                    <div class="space-y-1">
                        <label for="speedControl" class="block text-sm font-medium text-gray-700">T·ªëc ƒê·ªô: <span id="speedValue" class="text-sm font-bold text-indigo-600 float-right">5</span></label>
                        <input type="range" id="speedControl" min="1" max="15" value="5" step="1" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <div class="space-y-1">
                        <label for="intensityControl" class="block text-sm font-medium text-gray-700">C∆∞·ªùng ƒê·ªô (ƒê·ªô ƒê·∫≠m): <span id="intensityValue" class="text-sm font-bold text-indigo-600 float-right">70%</span></label>
                        <input type="range" id="intensityControl" min="0.0" max="1.0" value="0.7" step="0.05" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                    </div>
                    
                    <div class="space-y-1">
                        <label for="drawThicknessControl" class="block text-sm font-medium text-gray-700">ƒê·ªô D√†y N√©t V·∫Ω (Path): <span id="drawThicknessValue" class="text-sm font-bold text-indigo-600 float-right">3 px</span></label>
                        <input type="range" id="drawThicknessControl" min="1" max="10" value="3" step="1" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                    </div>
                </div>

                <div class="p-4 border rounded-lg bg-gray-50 space-y-3">
                    <p class="text-lg font-semibold text-gray-700">Ch·∫ø ƒê·ªô V·∫Ω/Ch·ªânh S·ª≠a</p>
                    <button id="addPathButton" disabled class="w-full py-2 px-3 bg-yellow-500 text-white font-bold rounded-lg shadow-md hover:bg-yellow-600 transition disabled:bg-gray-400 text-sm">
                        + Th√™m V√πng D√≤ng Ch·∫£y (ƒê∆∞·ªùng Line)
                    </button>
                    <button id="editPathButton" disabled class="w-full py-2 px-3 bg-pink-500 text-white font-bold rounded-lg shadow-md hover:bg-pink-600 transition disabled:bg-gray-400 text-sm">
                        Ch·ªçn/Ch·ªânh S·ª≠a V√πng V·∫Ω (Line)
                    </button>
                    <button id="addVectorFieldButton" disabled class="w-full py-2 px-3 bg-cyan-600 text-white font-bold rounded-lg shadow-md hover:bg-cyan-700 transition disabled:bg-gray-400 text-sm">
                        + Th√™m V√πng D√≤ng Ch·∫£y (Vector)
                    </button>
                    <div id="vectorDirectionControl" class="flex justify-around space-x-2 mt-2 hidden">
                        <button data-direction="right" class="direction-btn py-1 px-2 bg-gray-200 rounded text-sm hover:bg-gray-300">‚û°Ô∏è Ph·∫£i</button>
                        <button data-direction="left" class="direction-btn py-1 px-2 bg-gray-200 rounded text-sm hover:bg-gray-300">‚¨ÖÔ∏è Tr√°i</button>
                        <button data-direction="up" class="direction-btn py-1 px-2 bg-gray-200 rounded text-sm hover:bg-gray-300">‚¨ÜÔ∏è L√™n</button>
                        <button data-direction="down" class="direction-btn py-1 px-2 bg-gray-200 rounded text-sm hover:bg-gray-300">‚¨áÔ∏è Xu·ªëng</button>
                    </div>

                    <button id="resetPaths" class="w-full py-2 px-3 bg-red-600 text-white font-bold rounded-lg shadow-md hover:bg-red-700 transition text-sm">
                        X√≥a TO√ÄN B·ªò V√πng
                    </button>
                </div>
                
                <div class="p-4 border rounded-lg bg-gray-50 space-y-3">
                     <p class="text-lg font-semibold text-gray-700">M√¥ Ph·ªèng & Xu·∫•t File</p>
                    <button id="startStopSim" disabled class="w-full py-3 px-6 bg-green-600 text-white font-bold rounded-lg shadow-lg hover:bg-green-700 transition disabled:bg-gray-400 text-sm md:text-base">
                        B·∫ÆT ƒê·∫¶U M√¥ Ph·ªèng
                    </button>
                     <button id="generateGif" disabled class="w-full py-3 px-6 bg-purple-600 text-white font-bold rounded-lg shadow-lg hover:bg-purple-700 transition disabled:bg-gray-400 text-sm md:text-base">
                        T·∫°o T·ªáp GIF (Video 5s)
                    </button>
                </div>
                 <button onclick="openModal('helpModal')" class="w-full py-3 px-6 bg-blue-600 text-white font-bold rounded-lg shadow-lg hover:bg-blue-700 transition">
                    ? H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng Chi Ti·∫øt
                </button>
            </div>

            <div class="lg:w-3/4 space-y-4 order-1 lg:order-2">
                 <div id="statusMessage" class="text-center text-sm font-semibold text-indigo-700 bg-indigo-100 p-2 rounded-lg">Vui l√≤ng t·∫£i l√™n ·∫£nh n·ªÅn ƒë·ªÉ b·∫Øt ƒë·∫ßu.</div>

                <div class="relative canvas-area border-4 border-dashed border-gray-300 rounded-xl overflow-hidden flex justify-center items-center bg-white" style="min-height: 450px; height: 75vh;">
                    <canvas id="simulationCanvas" class="absolute inset-0 w-full h-full"></canvas>
                    <div id="placeholderText" class="absolute text-gray-500 text-xl text-center p-4">
                        1. T·∫£i l√™n B·∫£n V·∫Ω N·ªÅn ƒë·ªÉ b·∫Øt ƒë·∫ßu.
                    </div>
                </div>

                <div id="gifPreviewArea" class="mt-4 text-center hidden p-4 bg-white rounded-xl shadow-lg">
                    <h2 class="text-xl font-semibold mb-4 text-gray-800">Xem Tr∆∞·ªõc GIF ƒê√£ Xu·∫•t</h2>
                    <img id="gifPreview" class="max-w-full h-auto mx-auto rounded-lg shadow-2xl border-4 border-gray-200" alt="Xem tr∆∞·ªõc ·∫£nh GIF">
                    <a id="gifDownloadLink" download="material_flow_simulation.gif" class="mt-4 inline-block py-2 px-4 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition">
                        T·∫£i Xu·ªëng GIF
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div id="helpModal" class="modal fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 opacity-0 pointer-events-none">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-11/12 md:w-1/2 max-h-[90vh] overflow-y-auto transform transition-all duration-300 scale-95">
            <h3 class="text-xl font-bold text-gray-800 mb-4 border-b pb-2">H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng Chi Ti·∫øt (v1.1.0)</h3>
            <ol class="list-decimal list-inside space-y-2 text-gray-600 text-sm">
                <li>**T·∫£i ·∫¢nh N·ªÅn & V·∫≠t Li·ªáu:** T·∫£i l√™n b·∫£n v·∫Ω thi·∫øt b·ªã v√† h√¨nh ·∫£nh v·∫≠t li·ªáu.</li>
                <li>**Th√™m V√πng D√≤ng Ch·∫£y (ƒê∆∞·ªùng Line):** Nh·∫•n n√∫t, **Nh·∫•n v√† Gi·ªØ chu·ªôt** ƒë·ªÉ v·∫Ω ƒë∆∞·ªùng ƒëi t·ª± do. Nh·∫£ chu·ªôt ƒë·ªÉ k·∫øt th√∫c.</li>
                <li>**Ch·ªânh S·ª≠a V√πng Line (Quan tr·ªçng):** Nh·∫•n **"Ch·ªçn/Ch·ªânh S·ª≠a V√πng V·∫Ω (Line)"**. K√©o v√† Th·∫£ c√°c **ƒëi·ªÉm neo (ch·∫•m xanh)** ƒë·ªÉ u·ªën cong, tinh ch·ªânh ƒë∆∞·ªùng ƒëi ch√≠nh x√°c (gi·ªëng Powerpoint Edit Point). Nh·∫•n l·∫°i n√∫t ƒë·ªÉ tho√°t.</li>
                <li>**Th√™m V√πng D√≤ng Ch·∫£y (Vector - M·ªöI):** Nh·∫•n n√∫t, sau ƒë√≥ ch·ªçn **H∆∞·ªõng** (Ph·∫£i/Tr√°i/L√™n/Xu·ªëng). **Nh·∫•n v√† Gi·ªØ chu·ªôt** ƒë·ªÉ v·∫Ω **Khu v·ª±c** v·∫≠t li·ªáu s·∫Ω di chuy·ªÉn. M√¥ ph·ªèng n√†y kh√¥ng c·∫ßn ƒë∆∞·ªùng line v√† ch·ªâ √°p d·ª•ng trong v√πng v·∫Ω.</li>
                <li>**T√πy Ch·ªânh:** ƒêi·ªÅu ch·ªânh T·ªëc ƒê·ªô, C∆∞·ªùng ƒê·ªô (Opacity - kh√¥ng ƒë·ªÉ l·∫°i n√©t v·∫Ω), v√† ƒê·ªô D√†y N√©t V·∫Ω (ch·ªâ √°p d·ª•ng cho l·∫ßn v·∫Ω Line m·ªõi).</li>
                <li>**Ch·∫°y & Xu·∫•t File:** Nh·∫•n **"B·∫ÆT ƒê·∫¶U M√¥ Ph·ªèng"** v√† **"T·∫°o T·ªáp GIF"**.</li>
            </ol>
            <div class="mt-4 text-xs italic text-gray-500">
                L∆∞u √Ω: Ch·∫ø ƒë·ªô Vector Field kh√¥ng c·∫ßn ƒë∆∞·ªùng ƒëi c·ª• th·ªÉ, m√† m√¥ ph·ªèng s·ª± di chuy·ªÉn ƒë·ªìng b·ªô c·ªßa v·∫≠t li·ªáu trong m·ªôt v√πng k√≠n.
            </div>
            <div class="mt-6 flex justify-end">
                <button onclick="closeModal('helpModal')" class="py-2 px-4 bg-gray-300 text-gray-800 font-semibold rounded-lg hover:bg-gray-400 transition text-sm">ƒê√≥ng</button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/gif.js"></script>
    <script>
        // ... (PH·∫¶N JAVASCRIPT ƒê∆Ø·ª¢C C·∫¨P NH·∫¨T ·ªû M·ª§C 2)
    </script>
</body>
</html>
